<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Attendance</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  label { display: block; margin: 10px 0 5px; }
  input, select, button { padding: 5px; font-size: 14px; }
</style>
</head>
<body>

<h2>Employee Attendance</h2>

<form id="attendanceForm">
  <label for="name">Name:</label>
  <input type="text" id="name" name="name" placeholder="Enter your name" required>

  <label for="action">Action:</label>
  <select id="action" name="action">
    <option value="check-in">Check-in</option>
    <option value="check-out">Check-out</option>
  </select>

  <label for="remark">Remark (optional):</label>
  <input type="text" id="remark" name="remark" placeholder="Enter remark">

  <button type="submit">Submit</button>
</form>

<script>
const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbx4zAa6pfZHup4nQX2oHXhfRRWZ1XzBDdJIo0McNRWcvEuKup4YY_lDfD5NAHFPBiSspQ/exec';

document.getElementById('attendanceForm').addEventListener('submit', async (e) => {
  e.preventDefault(); // 阻止默认表单提交

  const name = document.getElementById('name').value.trim();
  const action = document.getElementById('action').value;
  const remark = document.getElementById('remark').value.trim();

  if (!name) {
    alert("Please enter your name.");
    return;
  }

  // 构造 GET 参数
  const params = new URLSearchParams({ name, action, remark });
  const url = `${WEB_APP_URL}?${params.toString()}`;

  try {
    const response = await fetch(url);
    if (!response.ok) throw new Error("Network response not ok");
    const text = await response.text();

    // 跳转到一个新页面显示结果
    const resultPage = window.open("", "_blank"); // 新窗口或标签页
    resultPage.document.write(`<pre style="font-family: Arial, sans-serif; font-size:16px;">${text}</pre>`);

  } catch (err) {
    alert("Request failed: " + err);
  }
});
</script>

</body>
</html>
